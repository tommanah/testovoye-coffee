import{H as i}from"./DLKcPPjX.js";const h=i("auth",{state:()=>({user:null,loading:!1}),getters:{isAuthenticated:r=>!!r.user,userFullName:r=>r.user?`${r.user.name} ${r.user.surname}`:""},actions:{async fetchUsers(){const r=await fetch("/data/users.json");if(!r.ok)throw new Error("Ошибка при загрузке пользователей");return await r.json()},async login(r,n){var s;this.loading=!0;try{const e=(await this.fetchUsers()).find(u=>u.credentials.username===r);if(!e)throw new Error("Sorry bro, но пользователь не найден");if(!e.active)throw new Error("Sorry bro, но пользователь уже не активен");const o=(s=e._comment)==null?void 0:s.match(/паролем '([^']+)'/),a=o?o[1]:null;if(!a||a!==n)throw new Error("Sorry bro, но пароль неверный");this.user=e,localStorage.setItem("auth_user",JSON.stringify(e))}catch(t){throw t}finally{this.loading=!1}},checkAuth(){const r=localStorage.getItem("auth_user");r&&(this.user=JSON.parse(r))},logout(){this.user=null,localStorage.removeItem("auth_user")}}});export{h as u};
